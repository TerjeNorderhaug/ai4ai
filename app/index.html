<!--
For HealthChainHack, Sep 2018
Author: Xinghua Liang
Copyright: BlockTEST LLC
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>AI4AI</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta content="yes" name="mobile-web-app-capable">

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css"
        integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B"
        crossorigin="anonymous">

  <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.css">

  <script src="./app.js"></script>
</head>
<body>
   <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">

     <button class="navbar-toggler" type="button"
             data-toggle="collapse" data-target="#navbarSupportedContent"
             aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
       <span class="navbar-toggler-icon"></span>
     </button>

     <a class="navbar-brand" href="#">
       <span style="color:teal"><b>AI<i>4</i>AI</b></span>
     </a>

     <div class="collapse navbar-collapse" id="navbarSupportedContent">
       <!--
       <ul class="navbar-nav nav-tabs mr-auto" role="tablist">
         <li class="nav-item">
           <a class="nav-link active" data-toggle="tab" href="#nav-tokens" id="nav-tokens-tab"
             aria-controls="nav-tokens" aria-selected="true">
             Tokens<span class="sr-only">(current)</span>
           </a>
         </li>
         <li class="nav-item">
           <a class="nav-link" data-toggle="tab" href="#nav-tasks" id="nav-tasks-tab"
             aria-controls="nav-tasks" aria-selected="false">
             Tasks
           </a>
         </li>
       </ul>
-->
      <div>
       <ul class="navbar-nav nav nav-pills" id="myTab" role="tablist">
         <li class="nav-item">
           <a class="nav-link active" id="home-tab" data-toggle="tab"
              href="#home" role="tab" aria-controls="home" aria-selected="true">Legitimation</a>
         </li>
         <li class="nav-item">
           <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab"
              aria-controls="profile" aria-selected="false">Tokens</a>
         </li>
         <li class="nav-item">
           <a class="nav-link" id="tasks-tab" data-toggle="tab"
              href="#tasks-pane" role="tab"
              aria-controls="tasks-pane" aria-selected="false">Tasks</a>
         </li>
       </ul>
       </div>
     </div>
     <!--
       <form class="form-inline my-2 my-lg-0">
         <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
         <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
       </form>
       -->
   </nav>

   <div class="container-fluid" style="margin: 0; padding: 0">

   <!--
   <div class="tab-content" id="myTabContent" style="font-size: 3em">
     <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">Home</div>
     <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">Profile</div>
     <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">Contact</div>
   </div>
   -->

   <div class="tab-content">
     <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
       <div class="card" id="legitimationPanel">
         <div class="card-body">
           <h5 class="card-title">Authenticate</h5>
           <div class="alert alert-info">
             <span id="legiStatus"></span>
           </div>
           <div class "form-group mb-3">
             <div class="custom-file">
               <label class="custom-file-label" for="legiFile" style="width:15em">Agreement</label>
               <input class="custom-file-input" type="file" id="legiFile"
                      value="legal_agreement.docx"
                      accept="*.*" onChange="App.openLegalFile(event)"></input>
             </div>
           </div>
           <div class="form-group">
             <label for="hashCode">SHA-256 Hash:</label>
             <input class="form-control" type="text" id="hashCode" readonly="true"></input>
           </div>
           <div class="form-group">
             <label for="hashSign">Hash Signature:</label>
             <input class="form-control" type="text" id="hashSign" readonly="true"
                    placeholder="Filled in after confirming the agreement in MetaMask"></input>
           </div>
           <div class="form-group">
             <label for="fileURL">Agreement URL:</label>
             <input class="form-control" type="text" id="fileURL"
                    defaultValue="https://github.com/TerjeNorderhaug/ai4ai/blob/master/legal_agreement.docx"
                    value="https://github.com/TerjeNorderhaug/ai4ai/blob/master/legal_agreement.docx"
                    placeholder="Save agreement to cloud, and input share link here"></input>
           </div>
           <div class="form-group">
             <button class="btn btn-primary" type="button" id="sign" onclick="App.signAgreement()">
               Sign Agreement
             </button>
           </div>
         </div>
       </div>

     </div>


       <!-- Loyality Token Panel (top level) -->
     <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
       <div class="card" id="loyaltyTokenPanel">
         <div class="card-body">
           <!-- <h3 class="card-title">Loyalty Token Management</h3>-->
           <div class="row">
             <div class="col" id="tokenInitialization">
               <div class="card">
                 <div class="card-body">
                   <h5 class="card-title">Loyalty Token Initialization</h5>
                   <label for="initSupply">Total Supply:</label>
                   <input class="form-control" type="text" id="initSupply" placeholder="e.g., 1000000"></input>
                   <div class="form-group">
                     <label for="initBonus">Bonus Tokens:</label>
                     <input class="form-control" type="text" id="initBonus" placeholder="e.g., 10000"></input>
                   </div>
                   <div class="form-group">
                     <label for="initName">Token Name:</label>
                     <input class="form-control" type="text" id="initName" placeholder="e.g., Loyalty Token"></input>
                   </div>
                   <div class="form-group">
                     <label for="initSymbol">Token Symbol:</label>
                     <input class="form-control" type="text" id="initSymbol" placeholder="e.g., LT"></input>
                   </div>

                   <button class="btn btn-primary" id="initToken" onclick="App.initLoyaltyToken()">
                     Initialize Loyalty Token
                   </button>
                 </div>
               </div>
             </div>


             <div class="col">
               <div class="card">
                 <div class="card-body">
                   <h4 class="card-title">General Information:</h4>
                   <p>Total Supply: <span id="totalSupply"></span></p>
                   <p>Bonus Tokens: <span id="bonusToken"></span></p>
                 </div>
               </div>
               <div class="card">
                 <div class="card-body">
                   <h4 class="card-title">Account Information:</h4>
                   <p>Account: <span id="accountAddress"></span></p>
                   <p>Balance: <span id="accountBalance"></span></p>
                 </div>
               </div>
               <div class="card">
                 <div class="card-body">
                   <h4 class="card-title">Send Loyalty Tokens</h4>
                   <div class="form-group">
                     <label for="amount">Amount:</label>
                     <input class="form-control" type="text" id="amount" placeholder="e.g., 100"></input>
                     <label for="receiver">To Address:</label>
                     <input class="form-control" type="text" id="receiver"
                            placeholder="e.g., 0xdf8114c4f533f72ea1bafafb7ca1836c54dbd3cc"></input>
                   </div>
                   <button class="btn btn-secondary" id="sendToken"
                           onclick="App.sendLoyaltyToken()">Send Loyalty Token</button>
                 </div>
               </div>
             </div>
           </div>
         </div>
       </div>
     </div>

     <!-- Tasks Pane -->
     <div class="tab-pane fade" role="tabpanel" aria-labelledby="tasks-tab"
          id="tasks-pane">
       <div class="card" id="taskManagementPanel">
         <div class="card-body">
           <h1 class="card-title">Task Management</h1>
           <div id="taskInitialization">
             <h4>Initialization:</h4>
             <div class="form-group">
               <label for="initSupply">Tool Name:</label>
               <input class="form-control" type="text" id="initToolName" placeholder="e.g., ADMET"></input>
               <label for="initPlayerSalary">Player Salary:</label>
               <input class="form-control" type="text" id="initPlayerSalary"
                      placeholder="Unit: ETH, e.g., 1"></input>
             </div>
             <button class="btn btn-primary" id="initTask"
                     onclick="App.initTaskManage()">Initialize Task</button>
           </div>

           <div>
             <h2>General Information:</h2>
             <p>Task Address: <span id="taskAddress"></span></p>
             <p>Task Balance: <span id="taskBalance"></span> ETH</p>
             <p>Task Name: <span id="taskName"></span></p>
             <p>Tool Name: <span id="toolName"></span></p>
             <p>Player Salary: <span id="playerSalary"></span> ETH</p>
           </div>

           <div>
             <h2>List of Tool Players:</h2>
             <ul id="playerList"></ul>
           </div>

           <div>
             <h2>List of Data Requests:</h2>
             <ul id="dataReqPool"></ul>
           </div>

           <div class="form-group">
             <label for="dataAccessCode">Data Access Code:</label>
             <div class="input-group mb-3">
               <input class="form-control" type="text" id="dataAccessCode"
                      placeholder="If you don't have one, click generate"></input>
               <div class="input-group-append">
                 <button class="btn btn-secondary" id="generateDataCode"
                         onclick="App.generateDataCode()">Generate Code</button>
               </div>
             </div>
             <label for="comPublicKey">Public Key:</label>
             <input class="form-control" type="text" id="comPublicKey" readonly="true"></input>
             <label for="playerId">Player ID:</label>
             <input class="form-control" type="text" id="playerId"
                    placeholder="Player ID to be approved"></input>
           </div>

           <div id="toolPlayerPanel">
             <br><br>
             <h2>For Tool Player:</h2>
             <br>
             <h3>Step 1: generate data access code,
               and submit request to accept the task.
               Then wait for task owner to approve the request</h3>
             <button class="btn btn-primary" id="submitPlayerRequest"
                     onclick="App.submitPlayerRequest()">New Player Request</button>

             <h3>Step 2: enter data access code and player id,
               locate inpute data, decrypte input data,
               do AI computation with the input data</h3>
             <div id="playerDecryptPanel">
               <button class="btn btn-primary" id="getDataInfo"
                       onclick="App.getDataInfo()">Locate Input Data</button>
               <label for="playerDataDecryptURL">Data Cloud URL:</label>
               <input class="form-control" type="text" id="playerDataDecryptURL"
                      readonly="true" placeholder="will show after encrypting data"></input>
               <label for="playerDataDecryptHash">Encrypted Data Hash:</label>
               <input class="form-control" type="text" id="playerDataDecryptHash"
                      readonly="true" placeholder="will show after encrypting data"></input>
               <div class="custom-file">
                 <label class="custom-file-label" for="openDecryptedFile">Data File:</label>
                 <input class="custom-file-input" type="file" id="openDecryptedFile" accept="*.*"
                        onChange="App.openDataFile(event)"></input>
               </div>
               <button class="btn btn-primary" id="decryptDataFile"
                       onclick="App.decryptDataFile()">Decrypt Data</button>
             </div>

             <h3>Step 3: enter player id, locate result request, encrypt result data,
               and submit to blockchain with result value.
               Then wait for task owner to validate the result</h3>
             <div id="playerEncryptPanel">
               <button class="btn btn-primary" id="getPlayerEncryptCode"
                       onclick="App.getEncryptCode()">Locate Result Request</button>
               <label for="playerEncryptCode">Data Encrypt Code:</label>
               <input class="form-control" type="text" id="playerEncryptCode"
                      readonly="true" placeholder="Obtained from blockchain"></input>
               <div class="custom-file">
                 <label class="custom-file-label" for="openDataFile">Data File:</label>
                 <input class="custom-file-input" type="file" id="openDataFile" accept="*.*"
                        onChange="App.openDataFile(event)"></input>
               </div>
               <button class="btn btn-primary" id="encryptDataFile"
                       onclick="App.encryptDataFile()">Encrypt Data</button>
               <label for="playerDataEncryptHash">Encrypted Data Hash:</label>
               <input class="form-control" type="text" id="playerDataEncryptHash"
                      readonly="true" placeholder="will show after encrypting data"></input>
               <label for="playerDataEncryptURL">Data Cloud URL:</label>
               <input class="form-control" type="text" id="playerDataEncryptURL"
                      placeholder="Save encrypted file to cloud, and input share link here"></input>
             </div>
             <label for="playerResult">Result Value:</label>
             <input class="form-control" type="text" id="playerResult"
                    placeholder="Final result"></input>
             <button class="btn btn-primary" id="submitPlayerResult"
                     onclick="App.submitPlayerResult()">Submit Player Result</button>
           </div>

           <div id="taskOwnerPanel">
             <br><br>
             <h2>For Task Owner:</h2>
             <br>
             <h3>Step 1: generate data access code, enter player id,
               encrypt input data, upload encrypted data to cloud,
               then approve player request</h3>
             <div id="ownerEncryptPanel">
               <button class="btn btn-primary" id="getOwnerEncryptCode"
                       onclick="App.getEncryptCode()">Locate Data Request</button>
               <div class="form-group">
                 <label for="ownerEncryptCode">Data Encrypt Code:</label>
                 <input class="form-control" type="text" id="ownerEncryptCode"
                        readonly="true" placeholder="Obtained from blockchain"></input>
                 <div class="custom-file">
                   <label class="custom-file-label" for="openDataFile">Data File:</label>
                   <input class="custom-file-input" type="file" id="openDataFile" accept="*.*"
                          onChange="App.openDataFile(event)"></input>
                 </div>
               </div>
               <button class="btn btn-primary" id="encryptDataFile"
                       onclick="App.encryptDataFile()">Encrypt Data</button>
               <label for="ownerDataEncryptHash">Encrypted Data Hash:</label>
               <input class="btn btn-primary" type="text" id="ownerDataEncryptHash"
                      readonly="true" placeholder="will show after encrypting data"></input>
               <label for="ownerDataEncryptURL">Data Cloud URL:</label>
               <input class="form-control" type="text" id="ownerDataEncryptURL"
                      placeholder="Save encrypted file to cloud, and input share link here"></input>
             </div>
             <button class="btn btn-primary" id="approvePlayerRequest"
                     onclick="App.approvePlayerRequest()">Approve Player Request</button>

             <h3>Step 2: enter data access code and player id,
               locate result data, decrypt result data,
               validate result with the value,
               then approve/reject player result</h3>
             <div id="ownerDecryptPanel">
               <button class="btn btn-primary" id="getDataInfo"
                       onclick="App.getDataInfo()">Locate Result Data</button>
               <div class="form-group">
                 <label for="ownerDataDecryptURL">Data Cloud URL:</label>
                 <input class="form-control" type="text" id="ownerDataDecryptURL" readonly="true"
                        placeholder="will show after encrypting data"></input>
                 <label for="ownerDataDecryptHash">Encrypted Data Hash:</label>
                 <input class="form-control" type="text" id="ownerDataDecryptHash" readonly="true"
                        placeholder="will show after encrypting data"></input>
               </div>
               <div class="custom-file">
                 <label class="custom-file-label" for="openEncryptedFile">Data File:</label>
                 <input class="custom-file-input" type="file" id="openEncryptedFile" accept="*.*"
                        onChange="App.openDataFile(event)"></input>
               </div>
               <button class="btn btn-primary" id="decryptDataFile"
                       onclick="App.decryptDataFile()">Decrypt Data</button>
             </div>

             <div>
               <label for="ownerResult">Result Value:</label>
               <input class="form-control" type="text" id="ownerResult" readonly="true"
                      placeholder="will show after encrypting data"></input>
               <button class="btn btn-primary" id="approvePlayerResult"
                       onclick="App.approvePlayerResult()">Approve Player Result</button>
               <button class="btn btn-primary" id="rejectPlayerResult"
                       onclick="App.rejectPlayerResult()">Reject Player Result</button>
             </div>
           </div>
         </div>
       </div>
     </div>
     <div style="height: 10em">&nbsp</div>
   </div>

   <footer class="fixed-bottom" style="padding-bottom:0">
     <div class="alert alert-warning center alert-dismissible fade show" role="alert"
          style="margin-bottom:0">
       <span class="hint">
         <strong>Status: </strong>
       </span>
       <span id="status"></span>
       <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
       </button>
     </div>
   </footer>

 </div>

 <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
         integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
         crossorigin="anonymous"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
         integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
         crossorigin="anonymous"></script>
 <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js"
         integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
         crossorigin="anonymous"></script>

</body>
</html>
